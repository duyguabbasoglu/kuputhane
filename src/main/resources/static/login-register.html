<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Giriş / Kayıt</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 flex items-center justify-center min-h-screen">

<div class="bg-white p-8 rounded shadow-md w-full max-w-md">
  <h2 class="text-2xl font-bold mb-4 text-center" id="form-title">Giriş Yap</h2>
  <form id="auth-form" class="space-y-4">
    <div>
      <label for="username" class="block">Kullanıcı Adı</label>
      <input type="text" id="username" class="w-full border rounded px-3 py-2" required />
    </div>
    <div>
      <label for="password" class="block">Şifre</label>
      <input type="password" id="password" class="w-full border rounded px-3 py-2" required />
    </div>
    <button type="submit" class="w-full bg-blue-600 text-white py-2 rounded">Devam Et</button>
  </form>
  <p class="text-sm text-center mt-4">
    <span id="toggle-text">Hesabınız yok mu?</span>
    <button id="toggle-button" class="text-blue-600 underline ml-1">Kayıt Ol</button>
  </p>
  <p id="auth-message" class="text-center text-red-500 mt-2 hidden"></p>
</div>

<script>
  const form = document.getElementById("auth-form");
  const formTitle = document.getElementById("form-title");
  const toggleButton = document.getElementById("toggle-button");
  const toggleText = document.getElementById("toggle-text");
  const authMessage = document.getElementById("auth-message");

  let isLogin = true;

  toggleButton.addEventListener("click", () => {
    isLogin = !isLogin;
    formTitle.textContent = isLogin ? "Giriş Yap" : "Kayıt Ol";
    toggleText.textContent = isLogin ? "Hesabınız yok mu?" : "Zaten hesabınız var mı?";
    toggleButton.textContent = isLogin ? "Kayıt Ol" : "Giriş Yap";
    authMessage.classList.add("hidden");
  });

  form.addEventListener("submit", (e) => {
    e.preventDefault();

    const username = document.getElementById("username").value;
    const password = document.getElementById("password").value;

    const endpoint = isLogin ? "/api/auth/login" : "/api/auth/register";

    fetch(endpoint, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ username, password }),
    })
            .then((res) => res.json())
            .then((data) => {
              if (data && data.username) {
                alert(isLogin ? "Giriş başarılı" : "Kayıt başarılı");
                // yönlendirme veya kullanıcı bilgisi saklama işlemleri
              } else {
                authMessage.textContent = isLogin
                        ? "Giriş başarısız. Bilgileri kontrol edin."
                        : "Kayıt başarısız. Kullanıcı mevcut olabilir.";
                authMessage.classList.remove("hidden");
              }
            })
            .catch(() => {
              authMessage.textContent = "Bir hata oluştu. Lütfen tekrar deneyin.";
              authMessage.classList.remove("hidden");
            });
  });
</script>
</body>
</html>
